<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Smart Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
  body {
    background: #ffffff;
    color: #000000;
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
  }

  .wrap {
    width: 800px;
    height: 480px;
    margin: 0 auto;
    padding: 10px;
    box-sizing: border-box;
  }

  h1 {
    font-size: 26px;
    margin: 0;
    border-bottom: 2px solid #000;
    padding-bottom: 4px;
  }

  .cols {
    display: flex;
    margin-top: 10px;
    gap: 10px;
  }

  .col {
    flex: 1;
    border: 2px solid #000;
    padding: 6px;
  }

  .section-title {
    font-size: 18px;
    font-weight: bold;
    border-bottom: 1px solid #000;
    margin-bottom: 6px;
  }

  .news-entry {
    margin-bottom: 8px;
    padding-bottom: 6px;
    border-bottom: 1px dotted #000;
    font-size: 14px;
    font-weight: 600;
  }

  .news-meta {
    font-size: 11px;
    font-weight: normal;
  }

  .crypto-row {
    font-size: 18px;
    margin-bottom: 6px;
    display: flex;
    justify-content: space-between;
  }

  .weather-day {
    font-size: 16px;
    margin-bottom: 6px;
  }
</style>
</head>

<body>
<div class="wrap">

  <h1>Smart Dashboard</h1>
  <div id="time"></div>

  <div class="cols">
    <!-- LEFT COLUMN: NEWS -->
    <div class="col">
      <div class="section-title">Google News (PL)</div>
      <div id="news">Ładowanie newsów…</div>
    </div>

    <!-- RIGHT COLUMN -->
    <div class="col">
      <div class="section-title">Kryptowaluty</div>
      <div id="crypto">Ładowanie cen…</div>

      <div class="section-title" style="margin-top:14px;">Pogoda – Bojano</div>
      <div id="weather">Ładowanie pogody…</div>
    </div>
  </div>

</div>

<script>
// ---------------- CLOCK ----------------
function updateClock() {
  const now = new Date();
  document.getElementById('time').innerHTML =
    now.toLocaleString("pl-PL");
}
setInterval(updateClock, 1000);
updateClock();

// ---------------- NEWS ----------------
async function loadNews() {
  const url =
    "https://news.google.com/rss?hl=pl&gl=PL&ceid=PL:pl";
  const rss = await fetch(url).then(r=>r.text());
  const items = [...rss.matchAll(/<item>([\s\S]*?)<\/item>/g)].slice(0,5);

  let html = "";
  items.forEach(it => {
    const block = it[1];
    const title = block.match(/<title><!\[CDATA\[(.*?)\]\]><\/title>/)?.[1] || "Brak tytułu";
    const source = block.match(/<source.*?>(.*?)<\/source>/)?.[1] || "";
    const date = block.match(/<pubDate>(.*?)<\/pubDate>/)?.[1] || "";

    html += `
      <div class="news-entry">
        ${title}<br>
        <span class="news-meta">${source} • ${date}</span>
      </div>
    `;
  });

  document.getElementById("news").innerHTML = html;
}
loadNews();

// ---------------- CRYPTO ----------------
async function loadCrypto() {
  const url = "https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum&vs_currencies=pln";
  const data = await fetch(url).then(r=>r.json());

  document.getElementById("crypto").innerHTML = `
    <div class="crypto-row"><b>BTC</b> <span>${data.bitcoin.pln.toLocaleString("pl-PL")} zł</span></div>
    <div class="crypto-row"><b>ETH</b> <span>${data.ethereum.pln.toLocaleString("pl-PL")} zł</span></div>
  `;
}
loadCrypto();

// ---------------- WEATHER ----------------
async function loadWeather() {
  const url =
    "https://api.open-meteo.com/v1/forecast?latitude=54.4712&longitude=18.3841&current_weather=true&daily=temperature_2m_max,temperature_2m_min,weathercode&forecast_days=3&timezone=auto";
  const data = await fetch(url).then(r=>r.json());

  const w = data.current_weather;
  const d = data.daily;

  let html = `
    <div class="weather-day"><b>Dziś:</b> ${w.temperature}°C</div>
  `;

  for (let i=1; i<d.time.length; i++) {
    const day = new Date(d.time[i]).toLocaleDateString("pl-PL", {weekday:"short"});
    html += `
      <div class="weather-day">${day}: ${d.temperature_2m_min[i]}–${d.temperature_2m_max[i]}°C</div>
    `;
  }

  document.getElementById("weather").innerHTML = html;
}
loadWeather();
</script>

</body>
</html>
